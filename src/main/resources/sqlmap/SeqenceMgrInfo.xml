<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap  
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"   
    "http://ibatis.apache.org/dtd/sql-map-2.dtd" >

<sqlMap namespace="seqenceMgrInfo">

  <typeAlias alias="seqenceMgrInfo" type="jp.co.sji.edu.fb.common.dto.SeqenceMgrInfo"/>

 
  <!-- IDを払出する-->
  <select id="selectSeqNo" parameterClass="String" resultClass="String">
    SELECT 
        SEQENCE + 1 
    FROM 
        SEQENCEMGRINFO
    WHERE 
        IDTYPE = #idType#
        <![CDATA[ 
        AND SEQENCE + 1 < IDEND
        ]]>
    FOR UPDATE WAIT 3
  </select>

  <update id="updateSeqNo" parameterClass="seqenceMgrInfo" >
    UPDATE SEQENCEMGRINFO
    SET
       SEQENCE = #seqence#
    WHERE
       IDTYPE = #iDType#
  </update>
  
</sqlMap>

